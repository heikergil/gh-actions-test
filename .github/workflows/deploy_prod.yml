name: Prod build
on:
   [release]
     
jobs:
    build:
        timeout-minutes: 30 # nothing good happens after 30 minutes
        name: Shopify Prod Build
        runs-on: ubuntu-latest
        outputs:
          themeid: ${{ steps.theme_id.outputs.value }}
          release_tag: ${{ github.event.release.tag_name }}
        steps:
            - uses: actions/checkout@v3
            - uses: actions/setup-node@v3
              with:
                node-version: 16

            - name: Cache node_modules
              uses: actions/cache@v3
              id: cache-node-module
              with:
                path: |
                  node_modules
                key: modules-${{ hashFiles('package-lock.json') }}

            - name: Install pakages
              if: steps.cache-node-modules.outputs.cache-hit != 'true'
              run: npm install

            - name: set-outputs
              run: echo ::set-output name=themeid::'Hello World'
            
            - name: set
              run: echo ${{ github.event.release.tag_name }}          

    # test:              
    #   name: E2E tests
    #   needs: build
    #   timeout-minutes: 30
    #   runs-on: ubuntu-latest
    #   # strategy:
    #   #   fail-fast: false
    #   #   matrix:
    #   #     shard: [1, 2, 3]
    #   steps:
    #   - uses: actions/checkout@v3
    #   - uses: actions/setup-node@v3

    #   - name: Cache node_modules
    #     uses: actions/cache@v3
    #     with:
    #       path: |
    #         node_modules
    #       key: modules-${{ hashFiles('package-lock.json') }}
      
    #   - name: echo something
    #     run: echo Hello World


    # deploy:
    #   name: publish shopify theme 
    #   needs: [build, test]
    #   timeout-minutes: 30
    #   runs-on: ubuntu-latest
    #   steps:
    #         - uses: actions/checkout@v3
    #         - uses: actions/setup-node@v3
    #           with:
    #             node-version: 16

    #         - name: Cache node_modules
    #           uses: actions/cache@v3
    #           id: cache-node-modules
    #           with:
    #             path: |
    #               node_modules
    #             key: modules-${{ hashFiles('package-lock.json') }}

    #         - name: echo something
    #           run: echo Hello World
            
